"use client"

import { useState, useEffect } from "react"
import { api } from "@/lib/api"

interface Article {
  id: string
  title: string
  lead: string
  content: string
  date: string
  readTime: number
  image: string
}

export function useNewsById(id: string) {
  const [data, setData] = useState<Article | null>(null)
  const [isLoading, setIsLoading] = useState(true)
  const [error, setError] = useState<Error | null>(null)

  useEffect(() => {
    const fetchArticle = async () => {
      setIsLoading(true)
      try {
        const response = await api.get(`/news/${id}`)
        setData(response.data)
        setError(null)
      } catch (err) {
        setError(err as Error)

        // Фейковые данные для демонстрации
        if (id === "1") {
          setData({
            id: "1",
            title: "Глобальные рынки растут на фоне сигналов о снижении ставок центробанками",
            lead: "Основные индексы в Азии, Европе и США выросли сегодня, поскольку центральные банки намекнули на возможное снижение процентных ставок в ближайшие месяцы.",
            content:
              'Финансовые рынки по всему миру испытали значительный рост сегодня, поскольку несколько центральных банков сигнализировали о потенциальном изменении денежно-кредитной политики. Федеральная резервная система, Европейский центральный банк и Банк Японии указали, что снижение процентных ставок может быть на горизонте, поскольку инфляционное давление ослабевает.\n\nИнвесторы положительно отреагировали на новости: индекс S&P 500 вырос на 2,3%, а индекс Nasdaq Composite подскочил на 3,1%. Европейские рынки последовали этому примеру: индекс Stoxx Europe 600 прибавил 1,8%.\n\nАналитики отмечают, что рынки уже начали учитывать в ценах потенциальное снижение ставок, что объясняет сильный рост акций, особенно в технологическом секторе, который особенно чувствителен к изменениям процентных ставок.\n\n"Мы видим явный сдвиг в риторике центральных банков, что дает инвесторам уверенность в том, что цикл повышения ставок подходит к концу", - сказал Алексей Петров, главный экономист инвестиционного банка "Капитал".\n\nОднако некоторые эксперты предупреждают о преждевременном оптимизме, отмечая, что инфляция все еще остается выше целевых показателей центральных банков, и что геополитические риски могут быстро изменить экономические перспективы.',
            date: "23 мая 2025",
            readTime: 5,
            image: "/placeholder.svg?height=600&width=1200",
          })
        }
      } finally {
        setIsLoading(false)
      }
    }

    if (id) {
      fetchArticle()
    }
  }, [id])

  return { data, isLoading, error }
}
